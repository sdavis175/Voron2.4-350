[gcode_macro START_PRINT]
gcode:
  {% set T_BED = params.T_BED|default(0)|float %}
  {% set T_EXTRUDER = params.T_EXTRUDER|default(0)|float %}
  {% set FL_SIZE = params.SIZE|default("0_0_0_0")|string %}

  M140 S{T_BED} # Start heating bed
  M104 S{T_EXTRUDER} # Start heating extruder

  M190 S{T_BED} # Wait for bed to reach temperature
  M109 S{T_EXTRUDER} # Wait for extruder to reach temperature
  G90 # Use absolute coordinates
  G32 # Home, QGL, Home

  ADAPTIVE_BED_MESH SIZE={FL_SIZE} # Run bed mesh
  PURGE_LINE
  G28 Z # Home Z now that bed is to temp

[gcode_macro PURGE_LINE]
gcode:
  G90 # Use absolute coordinates
  G92 E0 # Reset extruder
  G1 Z5.0 F3000 # Move z up little to prevent scratching of surface
  G1 X5 Y5 F5000 # Move to start-line position
  G1 Z0.2 F3000
  G1 X135 Y5 F500 E15  # Draw 1st line
  G1 X135 Y5.4 F5000 # Move to side a little
  G1 X5 Y5.4 F500 E30  # Draw 2nd line
  G92 E0 # Reset extruder
  G1 Z5.0 F3000 # Move z up little to prevent scratching of surface
